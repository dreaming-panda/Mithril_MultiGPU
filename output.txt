g001.anvil.rcac.purdue.edu
Fri Jan 20 20:21:19 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:C1:00.0 Off |                    0 |
| N/A   29C    P0    70W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

Currently Loaded Modules:
  1) modtree/gpu            5) mpfr/4.0.2    9) numactl/2.0.14
  2) nccl/cuda-11.2_2.8.4   6) mpc/1.1.0    10) cuda/11.4.2
  3) cudnn/cuda-11.2_8.1    7) gcc/11.2.0   11) openmpi/4.0.6
  4) gmp/6.2.1              8) zlib/1.2.11  12) boost/1.74.0

 

[  4%] Built target context
[ 19%] Built target core
[ 19%] Built target parallel
[ 40%] Built target cudahelp
[ 43%] Built target test_mpi_gpu_model_parallel
[ 58%] Built target test_cuda_graph
[ 58%] Built target test_mpi_gpu_pipelined_model_parallel
[ 58%] Built target test_hello_world
[ 58%] Built target test_cuda_pipeline_parallel
[ 58%] Built target test_mpi_gpu_hybrid
[ 67%] Built target test_nccl_thread
[ 67%] Built target test_full_structual_graph
[ 67%] Built target test_trivial
[ 67%] Built target test_mpi_model_parallel
[ 67%] Built target test_cuda_model_parallel
[ 71%] Built target test_mpi_pipelined_model_parallel
[ 73%] Built target test_cuda
[ 73%] Built target test_mpi_combined
[ 73%] Built target test_mpi_structual_graph
[ 73%] Built target test_single_node_training
[ 76%] Built target estimate_comm_volume
[ 77%] Built target test_single_node_fullgpu_training
[ 81%] Built target test_graph
[ 81%] Built target test_mpi_loader
[ 84%] Built target test_nccl_mpi
[ 87%] Built target test_single_node_gpu_training
[ 89%] Built target test_full_non_structual_graph
[ 89%] Built target test_mpi_non_structual_graph
[100%] Built target OSDI2023_MULTI_NODES_gcn
[100%] Built target test_two_layer_hybrid_parallelism_designer
[100%] Built target OSDI2023_SINGLE_NODE_gcn_inference
[100%] Built target OSDI2023_MULTI_NODES_gcn_graph_parallel
[100%] Built target OSDI2023_SINGLE_NODE_gcn
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 100
Learning rate: 0.001000
Initialized node g001.anvil.rcac.purdue.edu
Building the CSR structure...
        It takes 1.888 seconds.
Building the CSC structure...
        It takes 1.839 seconds.
Building the Feature Vector...
        It takes 0.665 seconds.
Building the Label Vector...
        It takes 0.379 seconds.
Number of classes: 47
Number of feature dimensions: 100
Dropout: 0.500 
train nodes 196615, valid nodes 39323, test nodes 2213091
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 47
    Number of vertices: 2449029
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
    Epoch 0:	Loss 3.89385	TrainAcc 0.0059	ValidAcc 0.0058	TestAcc 0.0128
    Epoch 1:	Loss 3.80555	TrainAcc 0.0428	ValidAcc 0.0476	TestAcc 0.0442
    Epoch 2:	Loss 3.69079	TrainAcc 0.3188	ValidAcc 0.3078	TestAcc 0.2186
    Epoch 3:	Loss 3.55814	TrainAcc 0.3888	ValidAcc 0.3841	TestAcc 0.2988
    Epoch 4:	Loss 3.41035	TrainAcc 0.3762	ValidAcc 0.3736	TestAcc 0.3053
    Epoch 5:	Loss 3.25055	TrainAcc 0.3654	ValidAcc 0.3632	TestAcc 0.3016
    Epoch 6:	Loss 3.08358	TrainAcc 0.3497	ValidAcc 0.3493	TestAcc 0.2947
    Epoch 7:	Loss 2.91684	TrainAcc 0.3446	ValidAcc 0.3445	TestAcc 0.2930
    Epoch 8:	Loss 2.75746	TrainAcc 0.3517	ValidAcc 0.3500	TestAcc 0.2961
    Epoch 9:	Loss 2.60555	TrainAcc 0.3648	ValidAcc 0.3619	TestAcc 0.3040
    Epoch 10:	Loss 2.44691	TrainAcc 0.3764	ValidAcc 0.3744	TestAcc 0.3158
    Epoch 11:	Loss 2.28028	TrainAcc 0.4144	ValidAcc 0.4156	TestAcc 0.3460
    Epoch 12:	Loss 2.12963	TrainAcc 0.4875	ValidAcc 0.4909	TestAcc 0.3976
    Epoch 13:	Loss 2.01087	TrainAcc 0.5454	ValidAcc 0.5452	TestAcc 0.4327
    Epoch 14:	Loss 1.91777	TrainAcc 0.5759	ValidAcc 0.5730	TestAcc 0.4503
    Epoch 15:	Loss 1.82911	TrainAcc 0.6125	ValidAcc 0.6063	TestAcc 0.4667
    Epoch 16:	Loss 1.74378	TrainAcc 0.6136	ValidAcc 0.6057	TestAcc 0.4698
    Epoch 17:	Loss 1.66522	TrainAcc 0.6056	ValidAcc 0.5998	TestAcc 0.4688
    Epoch 18:	Loss 1.59925	TrainAcc 0.6121	ValidAcc 0.6041	TestAcc 0.4714
    Epoch 19:	Loss 1.54533	TrainAcc 0.6105	ValidAcc 0.6051	TestAcc 0.4738
    Epoch 20:	Loss 1.48826	TrainAcc 0.6242	ValidAcc 0.6193	TestAcc 0.4846
    Epoch 21:	Loss 1.42615	TrainAcc 0.6671	ValidAcc 0.6598	TestAcc 0.5097
    Epoch 22:	Loss 1.36415	TrainAcc 0.7130	ValidAcc 0.7027	TestAcc 0.5395
    Epoch 23:	Loss 1.30685	TrainAcc 0.7405	ValidAcc 0.7311	TestAcc 0.5594
    Epoch 24:	Loss 1.26470	TrainAcc 0.7510	ValidAcc 0.7421	TestAcc 0.5701
    Epoch 25:	Loss 1.22677	TrainAcc 0.7547	ValidAcc 0.7472	TestAcc 0.5767
    Epoch 26:	Loss 1.19106	TrainAcc 0.7573	ValidAcc 0.7493	TestAcc 0.5812
    Epoch 27:	Loss 1.14935	TrainAcc 0.7669	ValidAcc 0.7604	TestAcc 0.5896
    Epoch 28:	Loss 1.10738	TrainAcc 0.7764	ValidAcc 0.7664	TestAcc 0.5979
    Epoch 29:	Loss 1.06803	TrainAcc 0.7848	ValidAcc 0.7772	TestAcc 0.6061
    Epoch 30:	Loss 1.03787	TrainAcc 0.7892	ValidAcc 0.7792	TestAcc 0.6082
    Epoch 31:	Loss 1.00970	TrainAcc 0.7929	ValidAcc 0.7835	TestAcc 0.6115
    Epoch 32:	Loss 0.98506	TrainAcc 0.7949	ValidAcc 0.7846	TestAcc 0.6144
    Epoch 33:	Loss 0.95896	TrainAcc 0.7996	ValidAcc 0.7918	TestAcc 0.6170
    Epoch 34:	Loss 0.93549	TrainAcc 0.8060	ValidAcc 0.7967	TestAcc 0.6222
    Epoch 35:	Loss 0.91242	TrainAcc 0.8100	ValidAcc 0.8028	TestAcc 0.6289
    Epoch 36:	Loss 0.89095	TrainAcc 0.8146	ValidAcc 0.8068	TestAcc 0.6321
    Epoch 37:	Loss 0.87114	TrainAcc 0.8154	ValidAcc 0.8091	TestAcc 0.6372
    Epoch 38:	Loss 0.85344	TrainAcc 0.8188	ValidAcc 0.8150	TestAcc 0.6415
    Epoch 39:	Loss 0.83779	TrainAcc 0.8218	ValidAcc 0.8174	TestAcc 0.6448
    Epoch 40:	Loss 0.82040	TrainAcc 0.8245	ValidAcc 0.8205	TestAcc 0.6488
    Epoch 41:	Loss 0.80438	TrainAcc 0.8268	ValidAcc 0.8214	TestAcc 0.6522
    Epoch 42:	Loss 0.78928	TrainAcc 0.8276	ValidAcc 0.8237	TestAcc 0.6540
    Epoch 43:	Loss 0.77253	TrainAcc 0.8315	ValidAcc 0.8265	TestAcc 0.6563
    Epoch 44:	Loss 0.76129	TrainAcc 0.8329	ValidAcc 0.8282	TestAcc 0.6579
    Epoch 45:	Loss 0.75085	TrainAcc 0.8329	ValidAcc 0.8292	TestAcc 0.6594
    Epoch 46:	Loss 0.73948	TrainAcc 0.8361	ValidAcc 0.8320	TestAcc 0.6600
    Epoch 47:	Loss 0.72921	TrainAcc 0.8376	ValidAcc 0.8331	TestAcc 0.6618
    Epoch 48:	Loss 0.71983	TrainAcc 0.8392	ValidAcc 0.8340	TestAcc 0.6626
    Epoch 49:	Loss 0.70940	TrainAcc 0.8420	ValidAcc 0.8365	TestAcc 0.6647
    Epoch 50:	Loss 0.70178	TrainAcc 0.8435	ValidAcc 0.8397	TestAcc 0.6661
    Epoch 51:	Loss 0.69133	TrainAcc 0.8459	ValidAcc 0.8412	TestAcc 0.6684
    Epoch 52:	Loss 0.68462	TrainAcc 0.8460	ValidAcc 0.8417	TestAcc 0.6693
    Epoch 53:	Loss 0.67892	TrainAcc 0.8491	ValidAcc 0.8437	TestAcc 0.6717
    Epoch 54:	Loss 0.67131	TrainAcc 0.8494	ValidAcc 0.8454	TestAcc 0.6728
    Epoch 55:	Loss 0.66437	TrainAcc 0.8509	ValidAcc 0.8455	TestAcc 0.6742
    Epoch 56:	Loss 0.65689	TrainAcc 0.8521	ValidAcc 0.8482	TestAcc 0.6746
    Epoch 57:	Loss 0.65236	TrainAcc 0.8525	ValidAcc 0.8475	TestAcc 0.6771
    Epoch 58:	Loss 0.64503	TrainAcc 0.8539	ValidAcc 0.8494	TestAcc 0.6777
    Epoch 59:	Loss 0.64000	TrainAcc 0.8540	ValidAcc 0.8496	TestAcc 0.6778
    Epoch 60:	Loss 0.63573	TrainAcc 0.8553	ValidAcc 0.8509	TestAcc 0.6788
    Epoch 61:	Loss 0.62864	TrainAcc 0.8553	ValidAcc 0.8520	TestAcc 0.6792
    Epoch 62:	Loss 0.62334	TrainAcc 0.8582	ValidAcc 0.8536	TestAcc 0.6806
    Epoch 63:	Loss 0.61781	TrainAcc 0.8597	ValidAcc 0.8530	TestAcc 0.6814
    Epoch 64:	Loss 0.61500	TrainAcc 0.8589	ValidAcc 0.8548	TestAcc 0.6825
    Epoch 65:	Loss 0.60889	TrainAcc 0.8605	ValidAcc 0.8549	TestAcc 0.6834
    Epoch 66:	Loss 0.60448	TrainAcc 0.8611	ValidAcc 0.8566	TestAcc 0.6842
    Epoch 67:	Loss 0.60119	TrainAcc 0.8625	ValidAcc 0.8572	TestAcc 0.6848
    Epoch 68:	Loss 0.59743	TrainAcc 0.8629	ValidAcc 0.8576	TestAcc 0.6846
    Epoch 69:	Loss 0.59368	TrainAcc 0.8639	ValidAcc 0.8576	TestAcc 0.6860
    Epoch 70:	Loss 0.58977	TrainAcc 0.8636	ValidAcc 0.8584	TestAcc 0.6861
    Epoch 71:	Loss 0.58534	TrainAcc 0.8649	ValidAcc 0.8582	TestAcc 0.6872
    Epoch 72:	Loss 0.58327	TrainAcc 0.8656	ValidAcc 0.8594	TestAcc 0.6873
    Epoch 73:	Loss 0.57875	TrainAcc 0.8664	ValidAcc 0.8599	TestAcc 0.6887
    Epoch 74:	Loss 0.57643	TrainAcc 0.8666	ValidAcc 0.8611	TestAcc 0.6894
    Epoch 75:	Loss 0.57301	TrainAcc 0.8675	ValidAcc 0.8615	TestAcc 0.6885
    Epoch 76:	Loss 0.56910	TrainAcc 0.8687	ValidAcc 0.8617	TestAcc 0.6894
    Epoch 77:	Loss 0.56496	TrainAcc 0.8689	ValidAcc 0.8620	TestAcc 0.6907
    Epoch 78:	Loss 0.56332	TrainAcc 0.8699	ValidAcc 0.8621	TestAcc 0.6903
    Epoch 79:	Loss 0.55943	TrainAcc 0.8711	ValidAcc 0.8646	TestAcc 0.6926
    Epoch 80:	Loss 0.55778	TrainAcc 0.8712	ValidAcc 0.8649	TestAcc 0.6924
    Epoch 81:	Loss 0.55465	TrainAcc 0.8713	ValidAcc 0.8635	TestAcc 0.6931
    Epoch 82:	Loss 0.55180	TrainAcc 0.8720	ValidAcc 0.8665	TestAcc 0.6933
    Epoch 83:	Loss 0.54895	TrainAcc 0.8726	ValidAcc 0.8659	TestAcc 0.6938
    Epoch 84:	Loss 0.54796	TrainAcc 0.8726	ValidAcc 0.8669	TestAcc 0.6939
    Epoch 85:	Loss 0.54321	TrainAcc 0.8746	ValidAcc 0.8677	TestAcc 0.6948
    Epoch 86:	Loss 0.54139	TrainAcc 0.8740	ValidAcc 0.8670	TestAcc 0.6951
    Epoch 87:	Loss 0.53970	TrainAcc 0.8738	ValidAcc 0.8673	TestAcc 0.6954
    Epoch 88:	Loss 0.53872	TrainAcc 0.8751	ValidAcc 0.8678	TestAcc 0.6956
    Epoch 89:	Loss 0.53434	TrainAcc 0.8755	ValidAcc 0.8699	TestAcc 0.6959
    Epoch 90:	Loss 0.53165	TrainAcc 0.8759	ValidAcc 0.8692	TestAcc 0.6965
    Epoch 91:	Loss 0.52896	TrainAcc 0.8766	ValidAcc 0.8687	TestAcc 0.6969
    Epoch 92:	Loss 0.52879	TrainAcc 0.8771	ValidAcc 0.8695	TestAcc 0.6969
    Epoch 93:	Loss 0.52739	TrainAcc 0.8762	ValidAcc 0.8695	TestAcc 0.6977
    Epoch 94:	Loss 0.52425	TrainAcc 0.8779	ValidAcc 0.8709	TestAcc 0.6983
    Epoch 95:	Loss 0.52238	TrainAcc 0.8774	ValidAcc 0.8704	TestAcc 0.6980
    Epoch 96:	Loss 0.52020	TrainAcc 0.8780	ValidAcc 0.8705	TestAcc 0.6984
    Epoch 97:	Loss 0.51853	TrainAcc 0.8779	ValidAcc 0.8720	TestAcc 0.6991
    Epoch 98:	Loss 0.51616	TrainAcc 0.8777	ValidAcc 0.8698	TestAcc 0.6998
    Epoch 99:	Loss 0.51488	TrainAcc 0.8783	ValidAcc 0.8711	TestAcc 0.6998

Average per-epoch runtime: 0.235 (s)
Total Time: 22.581(s)
loss Time: 0.066(s)
calacc Time: 0.581(s)
calgra Time: 0.469(s)
cf Time: 9.993(s)
cb Time: 12.728(s)
Highest validation acc: 0.8720
Target test acc: 0.6991
Epochs to reach the target acc: 98
The runtime of each operator:
	Op 0 (OPERATOR_INPUT),	Rumtime: 0.000000 s
	Op 1 (OPERATOR_WEIGHT),	Rumtime: 0.000000 s
	Op 2 (OPERATOR_MATMUL),	Rumtime: 1.224208 s
	Op 3 (OPERATOR_AGGREGATION),	Rumtime: 3.348661 s
	Op 4 (OPERATOR_RELU),	Rumtime: 0.553455 s
	Op 5 (OPERATOR_DROPOUT),	Rumtime: 0.411492 s
	Op 6 (OPERATOR_WEIGHT),	Rumtime: 0.000007 s
	Op 7 (OPERATOR_MATMUL),	Rumtime: 1.299925 s
	Op 8 (OPERATOR_AGGREGATION),	Rumtime: 3.347998 s
	Op 9 (OPERATOR_RELU),	Rumtime: 0.552872 s
	Op 10 (OPERATOR_DROPOUT),	Rumtime: 0.411217 s
	Op 11 (OPERATOR_WEIGHT),	Rumtime: 0.000003 s
	Op 12 (OPERATOR_MATMUL),	Rumtime: 1.299864 s
	Op 13 (OPERATOR_AGGREGATION),	Rumtime: 3.347776 s
	Op 14 (OPERATOR_RELU),	Rumtime: 0.552481 s
	Op 15 (OPERATOR_DROPOUT),	Rumtime: 0.410070 s
	Op 16 (OPERATOR_WEIGHT),	Rumtime: 0.000006 s
	Op 17 (OPERATOR_MATMUL),	Rumtime: 0.635352 s
	Op 18 (OPERATOR_AGGREGATION),	Rumtime: 2.742005 s
	Op 19 (OPERATOR_SOFTMAX),	Rumtime: 1.472578 s
