g005.anvil.rcac.purdue.edu
Tue Feb 14 21:04:38 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:01:00.0 Off |                    0 |
| N/A   29C    P0    52W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

Currently Loaded Modules:
  1) modtree/gpu            5) mpfr/4.0.2    9) numactl/2.0.14
  2) nccl/cuda-11.2_2.8.4   6) mpc/1.1.0    10) cuda/11.4.2
  3) cudnn/cuda-11.2_8.1    7) gcc/11.2.0   11) openmpi/4.0.6
  4) gmp/6.2.1              8) zlib/1.2.11  12) boost/1.74.0

 

[  4%] Built target context
[ 16%] Built target parallel
[ 19%] Built target core
[ 40%] Built target cudahelp
[ 56%] Built target test_cuda_graph
[ 56%] Built target test_mpi_gpu_pipelined_model_parallel
[ 56%] Built target test_mpi_gpu_model_parallel
[ 56%] Built target test_graph
[ 76%] Built target test_mpi_gpu_hybrid
[ 76%] Built target test_cuda_model_parallel
[ 76%] Built target test_mpi_structual_graph
[ 76%] Built target test_cuda
[ 76%] Built target test_mpi_combined
[ 76%] Built target test_nccl_thread
[ 76%] Built target test_trivial
[ 88%] Built target test_hello_world
[ 88%] Built target test_mpi_non_structual_graph
[ 88%] Built target test_full_structual_graph
[ 88%] Built target test_single_node_training
[ 88%] Built target test_single_node_fullgpu_training
[ 88%] Built target test_full_non_structual_graph
[ 88%] Built target test_cuda_pipeline_parallel
[ 89%] Built target estimate_comm_volume
[ 89%] Built target test_single_node_gpu_training
[ 88%] Built target test_mpi_pipelined_model_parallel
[ 88%] Built target test_mpi_loader
[ 88%] Built target test_nccl_mpi
[ 88%] Built target test_mpi_model_parallel
[ 95%] Built target OSDI2023_SINGLE_NODE_gcn
[ 97%] Built target test_two_layer_hybrid_parallelism_designer
[ 97%] Built target OSDI2023_MULTI_NODES_gcn
[100%] Built target OSDI2023_MULTI_NODES_gcn_graph_parallel
[100%] Built target OSDI2023_SINGLE_NODE_gcn_inference
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/metis_3_gpu/reddit/reorder/bin
The number of GCN layers: 6
The number of hidden units: 256
The number of training epoches: 5000
The number of startup epoches: 0
Learning rate: 0.003000
The partition strategy: hybrid
The dropout rate: 0.500
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/metis_3_gpu/reddit/reorder/bin
The number of GCN layers: 6
The number of hidden units: 256
The number of training epoches: 5000
The number of startup epoches: 0
Learning rate: 0.003000
The partition strategy: hybrid
The dropout rate: 0.500
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/metis_3_gpu/reddit/reorder/bin
The number of GCN layers: 6
The number of hidden units: 256
The number of training epoches: 5000
The number of startup epoches: 0
Learning rate: 0.003000
The partition strategy: hybrid
The dropout rate: 0.500
Initialized node g005.anvil.rcac.purdue.edu
Initialized node g007.anvil.rcac.purdue.edu
Initialized node g006.anvil.rcac.purdue.edu
Building the CSR structure...
Building the CSR structure...
Building the CSR structure...
        It takes 1.726 seconds.
Building the CSC structure...
        It takes 1.806 seconds.
Building the CSC structure...
        It takes 1.814 seconds.
Building the CSC structure...
        It takes 1.690 seconds.
        It takes 1.686 seconds.
        It takes 1.716 seconds.
Building the Feature Vector...
Building the Feature Vector...
Building the Feature Vector...
        It takes 0.284 seconds.
Building the Label Vector...
        It takes 0.027 seconds.
        It takes 0.379 seconds.
Building the Label Vector...
        It takes 0.389 seconds.
Building the Label Vector...
        It takes 0.071 seconds.
        It takes 0.061 seconds.
Number of classes: 41
Number of feature dimensions: 602
Number of classes: 41
Number of feature dimensions: 602
Number of classes: 41
Number of feature dimensions: 602
train nodes 153431, valid nodes 23831, test nodes 55703
train nodes 153431, valid nodes 23831, test nodes 55703
train nodes 153431, valid nodes 23831, test nodes 55703
start[0]: 0, end[0]: 79727start[1]: 79727, end[1]: 155167start[2]: 155167, end[2]: 232965[Node 0]: distributed graph prepared: start: 0, end: 79727 , send vertices: 215348.
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 41
    Number of vertices: 232965
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
[Node 1]: distributed graph prepared: start: 79727, end: 155167 , send vertices: 179288.
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 41
    Number of vertices: 232965
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
[Node 2]: distributed graph prepared: start: 155167, end: 232965 , send vertices: 209028.
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 41
    Number of vertices: 232965
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
232965
232965
232965
    Epoch 9:	Loss 1.77603	TrainAcc 0.6080	ValidAcc 0.6430	TestAcc 0.6390
    Epoch 19:	Loss 0.94407	TrainAcc 0.7539	ValidAcc 0.7739	TestAcc 0.7722
    Epoch 29:	Loss 0.67702	TrainAcc 0.8489	ValidAcc 0.8622	TestAcc 0.8589
    Epoch 39:	Loss 0.52166	TrainAcc 0.8856	ValidAcc 0.8979	TestAcc 0.8928
    Epoch 49:	Loss 0.44805	TrainAcc 0.9016	ValidAcc 0.9095	TestAcc 0.9083
    Epoch 59:	Loss 0.40900	TrainAcc 0.9116	ValidAcc 0.9175	TestAcc 0.9166
    Epoch 69:	Loss 0.38557	TrainAcc 0.9154	ValidAcc 0.9207	TestAcc 0.9211
    Epoch 79:	Loss 0.37090	TrainAcc 0.9172	ValidAcc 0.9225	TestAcc 0.9219
    Epoch 89:	Loss 0.36033	TrainAcc 0.9211	ValidAcc 0.9246	TestAcc 0.9255
    Epoch 99:	Loss 0.34747	TrainAcc 0.9226	ValidAcc 0.9266	TestAcc 0.9272
    Epoch 109:	Loss 0.33812	TrainAcc 0.9241	ValidAcc 0.9275	TestAcc 0.9277
    Epoch 119:	Loss 0.33234	TrainAcc 0.9258	ValidAcc 0.9289	TestAcc 0.9307
    Epoch 129:	Loss 0.32602	TrainAcc 0.9271	ValidAcc 0.9289	TestAcc 0.9302
    Epoch 139:	Loss 0.32400	TrainAcc 0.9276	ValidAcc 0.9311	TestAcc 0.9325
    Epoch 149:	Loss 0.31837	TrainAcc 0.9286	ValidAcc 0.9318	TestAcc 0.9337
    Epoch 159:	Loss 0.31561	TrainAcc 0.9296	ValidAcc 0.9312	TestAcc 0.9332
    Epoch 169:	Loss 0.31388	TrainAcc 0.9296	ValidAcc 0.9337	TestAcc 0.9331
    Epoch 179:	Loss 0.31009	TrainAcc 0.9304	ValidAcc 0.9332	TestAcc 0.9339
    Epoch 189:	Loss 0.30592	TrainAcc 0.9307	ValidAcc 0.9328	TestAcc 0.9340
slurmstepd: error: *** JOB 1147467 ON g005 CANCELLED AT 2023-02-14T21:05:58 ***
