g001.anvil.rcac.purdue.edu
Wed Feb  8 20:41:20 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:01:00.0 Off |                    0 |
| N/A   41C    P0    77W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

Currently Loaded Modules:
  1) modtree/gpu            5) mpfr/4.0.2    9) numactl/2.0.14
  2) nccl/cuda-11.2_2.8.4   6) mpc/1.1.0    10) cuda/11.4.2
  3) cudnn/cuda-11.2_8.1    7) gcc/11.2.0   11) openmpi/4.0.6
  4) gmp/6.2.1              8) zlib/1.2.11  12) boost/1.74.0

 

[  4%] Built target context
[ 19%] Built target core
[ 19%] Built target parallel
[ 40%] Built target cudahelp
[ 59%] Built target test_trivial
[ 63%] Built target test_cuda_graph
[ 59%] Built target test_single_node_gpu_training
[ 59%] Built target test_mpi_gpu_hybrid
[ 59%] Built target test_mpi_structual_graph
[ 70%] Built target test_graph
[ 70%] Built target test_cuda
[ 70%] Built target test_mpi_non_structual_graph
[ 70%] Built target test_cuda_model_parallel
[ 70%] Built target estimate_comm_volume
[ 70%] Built target test_nccl_thread
[ 70%] Built target test_nccl_mpi
[ 70%] Built target test_mpi_gpu_pipelined_model_parallel
[ 70%] Built target test_mpi_loader
[ 76%] Built target test_single_node_fullgpu_training
[ 76%] Built target test_mpi_pipelined_model_parallel
[ 76%] Built target test_mpi_combined
[ 77%] Built target test_mpi_model_parallel
[ 84%] Built target test_hello_world
[ 86%] Built target test_mpi_gpu_model_parallel
[ 87%] Built target test_single_node_training
[ 87%] Built target test_cuda_pipeline_parallel
[ 88%] Built target test_full_non_structual_graph
[ 89%] Built target test_full_structual_graph
[ 97%] Built target OSDI2023_SINGLE_NODE_gcn_inference
[ 97%] Built target test_two_layer_hybrid_parallelism_designer
[ 97%] Built target OSDI2023_MULTI_NODES_gcn
[100%] Built target OSDI2023_MULTI_NODES_gcn_graph_parallel
[100%] Built target OSDI2023_SINGLE_NODE_gcn
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/metis_4_gpu/ogbn_mag
The number of GCN layers: 8
The number of hidden units: 64
The number of training epoches: 100
The number of startup epoches: 0
Learning rate: 0.003000
The partition strategy: hybrid
The dropout rate: 0.300
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/metis_4_gpu/ogbn_mag
The number of GCN layers: 8
The number of hidden units: 64
The number of training epoches: 100
The number of startup epoches: 0
Learning rate: 0.003000
The partition strategy: hybrid
The dropout rate: 0.300
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/metis_4_gpu/ogbn_mag
The number of GCN layers: 8
The number of hidden units: 64
The number of training epoches: 100
The number of startup epoches: 0
Learning rate: 0.003000
The partition strategy: hybrid
The dropout rate: 0.300
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/metis_4_gpu/ogbn_mag
The number of GCN layers: 8
The number of hidden units: 64
The number of training epoches: 100
The number of startup epoches: 0
Learning rate: 0.003000
The partition strategy: hybrid
The dropout rate: 0.300
Initialized node g005.anvil.rcac.purdue.edu
Initialized node g004.anvil.rcac.purdue.edu
Initialized node g001.anvil.rcac.purdue.edu
Initialized node g002.anvil.rcac.purdue.edu
Building the CSR structure...
Building the CSR structure...
Building the CSR structure...
Building the CSR structure...
        It takes 0.235 seconds.
Building the CSC structure...
        It takes 0.233 seconds.
Building the CSC structure...
        It takes 0.235 seconds.
Building the CSC structure...
        It takes 0.236 seconds.
Building the CSC structure...
        It takes 0.169 seconds.
        It takes 0.170 seconds.
        It takes 0.172 seconds.
        It takes 0.176 seconds.
Building the Feature Vector...
Building the Feature Vector...
Building the Feature Vector...
Building the Feature Vector...
        It takes 0.339 seconds.
Building the Label Vector...
        It takes 0.341 seconds.
Building the Label Vector...
        It takes 0.330 seconds.
Building the Label Vector...
        It takes 0.344 seconds.
Building the Label Vector...
        It takes 0.698 seconds.
        It takes 0.698 seconds.
        It takes 0.700 seconds.
        It takes 0.714 seconds.
Number of classes: 349
Number of feature dimensions: 128
Number of classes: 349
Number of feature dimensions: 128
Number of classes: 349
Number of feature dimensions: 128
Number of classes: 349
Number of feature dimensions: 128
train nodes 629571, valid nodes 64879, test nodes 41939
train nodes 629571, valid nodes 64879, test nodes 41939
train nodes 629571, valid nodes 64879, test nodes 41939
train nodes 629571, valid nodes 64879, test nodes 41939
[Node 1]: distributed graph prepared: start: 186924, end: 373840 , send vertices: 92636.
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
start[0]: 0, end[0]: 186924start[1]: 186924, end[1]: 373840start[2]: 373840, end[2]: 555074start[3]: 555074, end[3]: 736389[Node 0]: distributed graph prepared: start: 0, end: 186924 , send vertices: 94252.
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_SOFTMAX
    OP_TYPE: OPERATOR_AGGREGATION
*** Done allocating resource.
*** Preparing the input tensor...
[Node 3]: distributed graph prepared: start: 555074, end: 736389 , send vertices: 96208.
    OP_TYPE: OPERATOR_SOFTMAX
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
*** Done allocating resource.
*** Preparing the input tensor...
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
[Node 2]: distributed graph prepared: start: 373840, end: 555074 , send vertices: 82860.
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_SOFTMAX
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
*** Done allocating resource.
*** Preparing the input tensor...
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 349
    Number of vertices: 736389
    Number of labels: 349
    Number of vertices: 736389
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 349
    Number of vertices: 736389
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 349
    Number of vertices: 736389
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
*** Done preparing the STD tensor.
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
*** Done preparing the weight tensor.

****** Start model training... ******
736389
736389
736389
736389
    Epoch 9:	Loss 5.16156	TrainAcc 0.0384	ValidAcc 0.0217	TestAcc 0.0165
    Epoch 19:	Loss 5.03679	TrainAcc 0.0505	ValidAcc 0.0323	TestAcc 0.0322
    Epoch 29:	Loss 4.86941	TrainAcc 0.0784	ValidAcc 0.0484	TestAcc 0.0448
    Epoch 39:	Loss 4.58319	TrainAcc 0.0891	ValidAcc 0.0534	TestAcc 0.0465
    Epoch 49:	Loss 4.43007	TrainAcc 0.1029	ValidAcc 0.0518	TestAcc 0.0695
    Epoch 59:	Loss 4.27289	TrainAcc 0.1133	ValidAcc 0.0631	TestAcc 0.0810
    Epoch 69:	Loss 4.13586	TrainAcc 0.1218	ValidAcc 0.0807	TestAcc 0.1013
    Epoch 79:	Loss 4.00767	TrainAcc 0.1478	ValidAcc 0.1156	TestAcc 0.1378
    Epoch 89:	Loss 3.87948	TrainAcc 0.1649	ValidAcc 0.1306	TestAcc 0.1548
    Epoch 99:	Loss 3.75732	TrainAcc 0.1739	ValidAcc 0.1459	TestAcc 0.1710

Average per-epoch runtime: 0.129 (s)
Highest validation acc: 0.1459
Target test acc: 0.1710
Epochs to reach the target acc: 100
Communication volume (cluster-wide, per-epoch): 1.087 GB
Communication time: 0.085 s
[MPI Rank 2] Success 
[MPI Rank 0] Success 
[MPI Rank 3] Success 
[MPI Rank 1] Success 
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_mag
The number of GCN layers: 8
The number of hidden units: 64
The number of training epoches: 0
Learning rate: 0.000000
Initialized node g001.anvil.rcac.purdue.edu
Building the CSR structure...
        It takes 0.185 seconds.
Building the CSC structure...
        It takes 0.180 seconds.
Building the Feature Vector...
        It takes 0.231 seconds.
Building the Label Vector...
        It takes 0.566 seconds.
Number of classes: 349
Number of feature dimensions: 128
Dropout: 0.000 
train nodes 629571, valid nodes 64879, test nodes 41939
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 349
    Number of vertices: 736389
*** Done preparing the STD tensor.
Version 0	TrainAcc 0.0448	ValidAcc 0.0348	TestAcc 0.0048
Version 1	TrainAcc 0.0380	ValidAcc 0.0591	TestAcc 0.0755
Version 2	TrainAcc 0.0728	ValidAcc 0.0842	TestAcc 0.0804
Version 3	TrainAcc 0.0827	ValidAcc 0.0939	TestAcc 0.0802
Version 4	TrainAcc 0.1044	ValidAcc 0.0985	TestAcc 0.0814
Version 5	TrainAcc 0.1131	ValidAcc 0.0988	TestAcc 0.0826
Version 6	TrainAcc 0.1255	ValidAcc 0.1039	TestAcc 0.0837
Version 7	TrainAcc 0.1552	ValidAcc 0.1194	TestAcc 0.0942
Version 8	TrainAcc 0.1726	ValidAcc 0.1341	TestAcc 0.2214
Version 9	TrainAcc 0.1774	ValidAcc 0.1540	TestAcc 0.2804
Version 9 achieved the highest validation accuracy 0.1540 (test accuracy: 0.2804)
