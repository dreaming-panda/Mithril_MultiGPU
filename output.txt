g002.anvil.rcac.purdue.edu
Sun Jan 22 19:42:09 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:C1:00.0 Off |                    0 |
| N/A   27C    P0    51W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

Currently Loaded Modules:
  1) modtree/gpu            5) mpfr/4.0.2    9) numactl/2.0.14
  2) nccl/cuda-11.2_2.8.4   6) mpc/1.1.0    10) cuda/11.4.2
  3) cudnn/cuda-11.2_8.1    7) gcc/11.2.0   11) openmpi/4.0.6
  4) gmp/6.2.1              8) zlib/1.2.11  12) boost/1.74.0

 

[  4%] Built target context
[ 18%] Built target parallel
[ 19%] Built target core
[ 40%] Built target cudahelp
[ 42%] Built target test_cuda
[ 45%] Built target test_mpi_gpu_hybrid
[ 53%] Built target test_mpi_combined
[ 55%] Built target test_mpi_structual_graph
[ 57%] Built target test_cuda_graph
[ 62%] Built target test_mpi_gpu_pipelined_model_parallel
[ 64%] Built target test_cuda_model_parallel
[ 64%] Built target test_trivial
[ 64%] Built target test_full_structual_graph
[ 72%] Built target test_mpi_loader
[ 72%] Built target test_hello_world
[ 72%] Built target test_mpi_non_structual_graph
[ 72%] Built target estimate_comm_volume
[ 73%] Built target test_cuda_pipeline_parallel
[ 74%] Built target test_mpi_gpu_model_parallel
[ 72%] Built target test_nccl_mpi
[ 75%] Built target test_full_non_structual_graph
[ 79%] Built target test_graph
[ 80%] Built target test_single_node_gpu_training
[ 83%] Built target test_mpi_pipelined_model_parallel
[ 83%] Built target test_nccl_thread
[ 85%] Built target test_single_node_training
[ 89%] Built target test_single_node_fullgpu_training
[ 89%] Built target test_mpi_model_parallel
[ 92%] Built target OSDI2023_MULTI_NODES_gcn_graph_parallel
[ 94%] Built target OSDI2023_SINGLE_NODE_gcn_inference
[ 95%] Built target OSDI2023_MULTI_NODES_gcn
[ 97%] Built target OSDI2023_SINGLE_NODE_gcn
[100%] Built target test_two_layer_hybrid_parallelism_designer
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 3
The number of hidden units: 128
The number of training epoches: 100
Learning rate: 0.003000
Initialized node g002.anvil.rcac.purdue.edu
Building the CSR structure...
        It takes 1.922 seconds.
Building the CSC structure...
        It takes 1.889 seconds.
Building the Feature Vector...
        It takes 0.572 seconds.
Building the Label Vector...
        It takes 0.310 seconds.
Number of classes: 47
Number of feature dimensions: 100
Dropout: 0.300 
train nodes 196615, valid nodes 39323, test nodes 2213091
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 47
    Number of vertices: 2449029
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
    Epoch 9:	Loss 1.55486	TrainAcc 0.7042	ValidAcc 0.6980	TestAcc 0.5285
    Epoch 19:	Loss 0.87481	TrainAcc 0.8226	ValidAcc 0.8173	TestAcc 0.6496
    Epoch 29:	Loss 0.66867	TrainAcc 0.8591	ValidAcc 0.8528	TestAcc 0.6865
    Epoch 39:	Loss 0.58305	TrainAcc 0.8735	ValidAcc 0.8677	TestAcc 0.6955
    Epoch 49:	Loss 0.52748	TrainAcc 0.8817	ValidAcc 0.8752	TestAcc 0.7045
    Epoch 59:	Loss 0.49329	TrainAcc 0.8852	ValidAcc 0.8797	TestAcc 0.7142
    Epoch 69:	Loss 0.47016	TrainAcc 0.8886	ValidAcc 0.8822	TestAcc 0.7158
    Epoch 79:	Loss 0.45287	TrainAcc 0.8920	ValidAcc 0.8846	TestAcc 0.7204
    Epoch 89:	Loss 0.43978	TrainAcc 0.8937	ValidAcc 0.8874	TestAcc 0.7234
    Epoch 99:	Loss 0.42880	TrainAcc 0.8959	ValidAcc 0.8889	TestAcc 0.7270

Average per-epoch runtime: 0.176 (s)
Total Time: 16.941(s)
loss Time: 0.066(s)
calacc Time: 0.582(s)
calgra Time: 0.470(s)
cf Time: 7.459(s)
cb Time: 9.340(s)
Highest validation acc: 0.8894
Target test acc: 0.7256
Epochs to reach the target acc: 95
The runtime of each operator:
	Op 0 (OPERATOR_INPUT),	Rumtime: 0.000000 s
	Op 1 (OPERATOR_WEIGHT),	Rumtime: 0.000000 s
	Op 2 (OPERATOR_MATMUL),	Rumtime: 1.223439 s
	Op 3 (OPERATOR_AGGREGATION),	Rumtime: 3.352128 s
	Op 4 (OPERATOR_RELU),	Rumtime: 0.553442 s
	Op 5 (OPERATOR_DROPOUT),	Rumtime: 0.411375 s
	Op 6 (OPERATOR_WEIGHT),	Rumtime: 0.000005 s
	Op 7 (OPERATOR_MATMUL),	Rumtime: 1.301634 s
	Op 8 (OPERATOR_AGGREGATION),	Rumtime: 3.351838 s
	Op 9 (OPERATOR_RELU),	Rumtime: 0.552973 s
	Op 10 (OPERATOR_DROPOUT),	Rumtime: 0.412036 s
	Op 11 (OPERATOR_WEIGHT),	Rumtime: 0.000007 s
	Op 12 (OPERATOR_MATMUL),	Rumtime: 0.636287 s
	Op 13 (OPERATOR_AGGREGATION),	Rumtime: 2.745340 s
	Op 14 (OPERATOR_SOFTMAX),	Rumtime: 1.475599 s
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 3
The number of hidden units: 128
The number of training epoches: 0
Learning rate: 0.000000
Initialized node g002.anvil.rcac.purdue.edu
Building the CSR structure...
        It takes 1.891 seconds.
Building the CSC structure...
        It takes 1.857 seconds.
Building the Feature Vector...
        It takes 0.569 seconds.
Building the Label Vector...
        It takes 0.311 seconds.
Number of classes: 47
Number of feature dimensions: 100
Dropout: 0.000 
train nodes 196615, valid nodes 39323, test nodes 2213091
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 47
    Number of vertices: 2449029
*** Done preparing the STD tensor.
Version 0	TrainAcc 0.7123	ValidAcc 0.7049	TestAcc 0.5463
Version 1	TrainAcc 0.8271	ValidAcc 0.8228	TestAcc 0.6580
Version 2	TrainAcc 0.8605	ValidAcc 0.8559	TestAcc 0.6953
Version 3	TrainAcc 0.8749	ValidAcc 0.8696	TestAcc 0.7032
Version 4	TrainAcc 0.8826	ValidAcc 0.8766	TestAcc 0.7102
Version 5	TrainAcc 0.8868	ValidAcc 0.8814	TestAcc 0.7210
Version 6	TrainAcc 0.8900	ValidAcc 0.8835	TestAcc 0.7235
Version 7	TrainAcc 0.8928	ValidAcc 0.8860	TestAcc 0.7271
Version 8	TrainAcc 0.8949	ValidAcc 0.8882	TestAcc 0.7312
Version 9	TrainAcc 0.8972	ValidAcc 0.8903	TestAcc 0.7347
