g002.anvil.rcac.purdue.edu
Tue Jan 24 00:26:49 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:01:00.0 Off |                    0 |
| N/A   27C    P0    50W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   1  NVIDIA A100-SXM...  On   | 00000000:41:00.0 Off |                    0 |
| N/A   27C    P0    51W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   2  NVIDIA A100-SXM...  On   | 00000000:81:00.0 Off |                    0 |
| N/A   28C    P0    53W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
|   3  NVIDIA A100-SXM...  On   | 00000000:C1:00.0 Off |                    0 |
| N/A   27C    P0    51W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

Currently Loaded Modules:
  1) modtree/gpu            5) mpfr/4.0.2    9) numactl/2.0.14
  2) nccl/cuda-11.2_2.8.4   6) mpc/1.1.0    10) cuda/11.4.2
  3) cudnn/cuda-11.2_8.1    7) gcc/11.2.0   11) openmpi/4.0.6
  4) gmp/6.2.1              8) zlib/1.2.11  12) boost/1.74.0

 

[  4%] Built target context
[ 17%] Built target parallel
[ 19%] Built target core
[ 39%] Built target cudahelp
[ 44%] Built target test_cuda_graph
[ 46%] Built target test_nccl_thread
[ 48%] Built target test_mpi_gpu_model_parallel
[ 51%] Built target test_mpi_gpu_hybrid
[ 66%] Built target test_mpi_gpu_pipelined_model_parallel
[ 66%] Built target test_trivial
[ 66%] Built target test_hello_world
[ 66%] Built target test_graph
[ 85%] Built target estimate_comm_volume
[ 85%] Built target test_cuda_pipeline_parallel
[ 85%] Built target test_single_node_fullgpu_training
[ 85%] Built target test_mpi_non_structual_graph
[ 85%] Built target test_mpi_structual_graph
[ 85%] Built target test_cuda_model_parallel
[ 85%] Built target test_cuda_data_compression
[ 91%] Built target test_full_non_structual_graph
[ 91%] Built target test_mpi_model_parallel
[ 91%] Built target test_full_structual_graph
[ 91%] Built target test_mpi_pipelined_model_parallel
[ 85%] Built target test_mpi_combined
[ 91%] Built target test_mpi_loader
[ 91%] Built target test_nccl_mpi
[ 85%] Built target test_cuda
[ 91%] Built target test_single_node_training
[ 91%] Built target test_single_node_gpu_training
[ 97%] Built target OSDI2023_SINGLE_NODE_gcn
[100%] Built target OSDI2023_SINGLE_NODE_gcn_inference
[100%] Built target test_two_layer_hybrid_parallelism_designer
[100%] Built target OSDI2023_MULTI_NODES_gcn
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 1000
The number of startup epoches: 0
Learning rate: 0.010000
The partition strategy: model
The dropout rate: 0.500
The checkpointed weight file: saved_weights
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 1000
The number of startup epoches: 0
Learning rate: 0.010000
The partition strategy: model
The dropout rate: 0.500
The checkpointed weight file: saved_weights
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 1000
The number of startup epoches: 0
Learning rate: 0.010000
The partition strategy: model
The dropout rate: 0.500
The checkpointed weight file: saved_weights
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 1000
The number of startup epoches: 0
Learning rate: 0.010000
The partition strategy: model
The dropout rate: 0.500
The checkpointed weight file: saved_weights
Initialized node 1 on machine g002.anvil.rcac.purdue.edu
Initialized node 3 on machine g002.anvil.rcac.purdue.edu
Initialized node 2 on machine g002.anvil.rcac.purdue.edu
Initialized node 0 on machine g002.anvil.rcac.purdue.edu
Building the CSR structure...
Building the CSR structure...
Building the CSR structure...
Building the CSR structure...
        It takes 2.039 seconds.
Building the CSC structure...
        It takes 2.056 seconds.
Building the CSC structure...
        It takes 2.125 seconds.
Building the CSC structure...
        It takes 2.131 seconds.
Building the CSC structure...
        It takes 1.972 seconds.
        It takes 1.974 seconds.
        It takes 1.992 seconds.
        It takes 2.008 seconds.
Building the Feature Vector...
Building the Feature Vector...
Building the Feature Vector...
Building the Feature Vector...
        It takes 0.852 seconds.
Building the Label Vector...
        It takes 0.905 seconds.
Building the Label Vector...
        It takes 0.804 seconds.
Building the Label Vector...
        It takes 0.822 seconds.
Building the Label Vector...
        It takes 0.523 seconds.
Number of classes: 47
Number of feature dimensions: 100
Number of vertices: 2449029
        It takes 0.586 seconds.
Number of classes: 47
Number of feature dimensions: 100
Number of vertices: 2449029
        It takes 0.576 seconds.
Number of classes: 47
Number of feature dimensions: 100
Number of vertices: 2449029
        It takes 0.431 seconds.
Number of classes: 47
Number of feature dimensions: 100
Number of vertices: 2449029
train nodes 196615, valid nodes 39323, test nodes 2213091
train nodes 196615, valid nodes 39323, test nodes 2213091
train nodes 196615, valid nodes 39323, test nodes 2213091
Number of GPUs: 4
WARNING: the current version only applies to linear GNN models!
GPU 0, layer [0, 1)
GPU 1, layer [1, 2)
GPU 2, layer [2, 3)
GPU 3, layer [3, 4)
*** Node 1, starting model training...
Number of operators: 20
0 2449029 0 6
0 2449029 6 11
0 2449029 11 16
0 2449029 16 20
Node 1, Pipeline Input Tensor: OPERATOR_DROPOUT
Node 1, Pipeline Output Tensor: OPERATOR_DROPOUT
*** Node 1 owns the partition [6, 11) x [0, 2449029)
*** Node 1, constructing the helper classes...
train nodes 196615, valid nodes 39323, test nodes 2213091
Number of GPUs: 4
WARNING: the current version only applies to linear GNN models!
GPU 0, layer [0, 1)
GPU 1, layer [1, 2)
GPU 2, layer [2, 3)
GPU 3, layer [3, 4)
*** Node 2, starting model training...
Number of operators: 20
0 2449029 0 6
0 2449029 6 11
0 2449029 11 16
0 2449029 16 20
Node 2, Pipeline Input Tensor: OPERATOR_DROPOUT
Node 2, Pipeline Output Tensor: OPERATOR_DROPOUT
*** Node 2 owns the partition [11, 16) x [0, 2449029)
*** Node 2, constructing the helper classes...
Number of GPUs: 4
GPU 0, layer [0, 1)
GPU 1, layer [1, 2)
GPU 2, layer [2, 3)
GPU 3, layer [3, 4)
*** Node 0, starting model training...
Number of operators: 20
0 2449029 0 6
0 2449029 6 11
0 2449029 11 16
0 2449029 16 20
Node 0, Pipeline Input Tensor: NULL
WARNING: the current version only applies to linear GNN models!
Node 0, Pipeline Output Tensor: OPERATOR_DROPOUT
*** Node 0 owns the partition [0, 6) x [0, 2449029)
*** Node 0, constructing the helper classes...
Operators:
    Op 0: type OPERATOR_INPUT, output tensors: 0
    Op 1: type OPERATOR_WEIGHT, output tensors: 1
    Op 2: type OPERATOR_MATMUL, output tensors: 2
    Op 3: type OPERATOR_AGGREGATION, output tensors: 3
    Op 4: type OPERATOR_RELU, output tensors: 4
    Op 5: type OPERATOR_DROPOUT, output tensors: 5
    Op 6: type OPERATOR_WEIGHT, output tensors: 6
    Op 7: type OPERATOR_MATMUL, output tensors: 7
    Op 8: type OPERATOR_AGGREGATION, output tensors: 8
    Op 9: type OPERATOR_RELU, output tensors: 9
    Op 10: type OPERATOR_DROPOUT, output tensors: 10
    Op 11: type OPERATOR_WEIGHT, output tensors: 11
    Op 12: type OPERATOR_MATMUL, output tensors: 12
    Op 13: type OPERATOR_AGGREGATION, output tensors: 13
    Op 14: type OPERATOR_RELU, output tensors: 14
    Op 15: type OPERATOR_DROPOUT, output tensors: 15
    Op 16: type OPERATOR_WEIGHT, output tensors: 16
    Op 17: type OPERATOR_MATMUL, output tensors: 17
    Op 18: type OPERATOR_AGGREGATION, output tensors: 18
    Op 19: type OPERATOR_SOFTMAX, output tensors: 19
Number of GPUs: 4
GPU 0, layer [0, 1)
GPU 1, layer [1, 2)
GPU 2, layer [2, 3)
GPU 3, layer [3, 4)
*** Node 3, starting model training...
Number of operators: 20
0 2449029 0 6
0 2449029 6 11
0 2449029 11 16
0 2449029 16 20
WARNING: the current version only applies to linear GNN models!
Node 3, Pipeline Input Tensor: OPERATOR_DROPOUT
Node 3, Pipeline Output Tensor: NULL
*** Node 3 owns the partition [16, 20) x [0, 2449029)
*** Node 3, constructing the helper classes...
(Forwarding) Node 3 (fragment 0) depends on nodes: 2 (Tensor: 15)
(Backwarding) Node 3 (fragment 0) depends on nodes:
(I-link dependencies): node 3 should send activation to nodes:
(I-link dependencies): node 3 should receive activation from nodes:
(I-link dependencies): node 3 should send gradient to nodes:
(I-link dependencies): node 3 should receive gradient from nodes:
(Forwarding) Node 1 (fragment 0) depends on nodes: 0 (Tensor: 5)
(Backwarding) Node 1 (fragment 0) depends on nodes: 2 (Tensor: 10)
(I-link dependencies): node 1 should send activation to nodes:
(I-link dependencies): node 1 should receive activation from nodes:
(I-link dependencies): node 1 should send gradient to nodes:
(I-link dependencies): node 1 should receive gradient from nodes:
Boundaries: 0 0 0 0 2449029 2449029 2449029 2449029
Fragments: [0, 2449029)
Chunks (number of global chunks: 32): 0-[0, 76533) 1-[76533, 153066) 2-[153066, 229599) 3-[229599, 306132) 4-[306132, 382665) 5-[382665, 459198) 6-[459198, 535731) 7-[535731, 612264) 8-[612264, 688797) ... 31-[2372523, 2449029)
(Forwarding) Node 0 (fragment 0) depends on nodes:
(Backwarding) Node 0 (fragment 0) depends on nodes: 1 (Tensor: 5)
(I-link dependencies): node 0 should send activation to nodes:
(I-link dependencies): node 0 should receive activation from nodes:
(Forwarding) Node 2 (fragment 0) depends on nodes: 1 (Tensor: 10)
(Backwarding) Node 2 (fragment 0) depends on nodes: 3 (Tensor: 15)
(I-link dependencies): node 0 should send gradient to nodes:
(I-link dependencies): node 0 should receive gradient from nodes:
(I-link dependencies): node 2 should send activation to nodes:
(I-link dependencies): node 2 should receive activation from nodes:
(I-link dependencies): node 2 should send gradient to nodes:
(I-link dependencies): node 2 should receive gradient from nodes:
2449029, 126167053, 126167053
2449029, 126167053, 126167053
2449029, 126167053, 126167053
2449029, 126167053, 126167053
csr in-out ready !*** Node 0, setting up some other necessary information...
csr in-out ready !*** Node 3, setting up some other necessary information...
csr in-out ready !*** Node 2, setting up some other necessary information...
csr in-out ready !*** Node 1, setting up some other necessary information...
*** Node 2, starting the helper threads...
*** Node 0, starting the helper threads...
*** Node 3, starting the helper threads...
*** Node 1, starting the helper threads...
+++++++++ Node 0 initializing the weights for op[0, 6)...
+++++++++ Node 0, mapping weight op 1
+++++++++ Node 2 initializing the weights for op[11, 16)...
+++++++++ Node 2, mapping weight op 11
+++++++++ Node 1 initializing the weights for op[6, 11)...
+++++++++ Node 1, mapping weight op 6
+++++++++ Node 3 initializing the weights for op[16, 20)...
+++++++++ Node 3, mapping weight op 16
RANDOMLY DISPATCH THE CHUNKS...
*** Node 0, starting task scheduling...
*** Node 3, starting task scheduling...
*** Node 2, starting task scheduling...
*** Node 1, starting task scheduling...



The learning rate specified by the user: 0.010000000
The learning rate specified by the user: 0.010000000
The learning rate specified by the user: 0.010000000
The learning rate specified by the user: 0.010000000
    Epoch 9:	Loss 3.04117	TrainAcc 0.4200	ValidAcc 0.4277	TestAcc 0.3560
    Epoch 19:	Loss 1.53141	TrainAcc 0.6554	ValidAcc 0.6516	TestAcc 0.4946
    Epoch 29:	Loss 1.08840	TrainAcc 0.7877	ValidAcc 0.7853	TestAcc 0.6006
    Epoch 39:	Loss 0.82678	TrainAcc 0.8337	ValidAcc 0.8261	TestAcc 0.6545
    Epoch 49:	Loss 0.69871	TrainAcc 0.8481	ValidAcc 0.8386	TestAcc 0.6628
    Epoch 59:	Loss 0.60305	TrainAcc 0.8669	ValidAcc 0.8630	TestAcc 0.6837
    Epoch 69:	Loss 0.54642	TrainAcc 0.8742	ValidAcc 0.8676	TestAcc 0.6909
    Epoch 79:	Loss 0.50813	TrainAcc 0.8805	ValidAcc 0.8718	TestAcc 0.6967
    Epoch 89:	Loss 0.48113	TrainAcc 0.8842	ValidAcc 0.8760	TestAcc 0.7000
    Epoch 99:	Loss 0.46302	TrainAcc 0.8879	ValidAcc 0.8787	TestAcc 0.7100
    Epoch 109:	Loss 0.44832	TrainAcc 0.8896	ValidAcc 0.8816	TestAcc 0.7141
    Epoch 119:	Loss 0.43536	TrainAcc 0.8927	ValidAcc 0.8846	TestAcc 0.7212
    Epoch 129:	Loss 0.42578	TrainAcc 0.8955	ValidAcc 0.8870	TestAcc 0.7202
    Epoch 139:	Loss 0.42100	TrainAcc 0.8932	ValidAcc 0.8836	TestAcc 0.7244
    Epoch 149:	Loss 0.41418	TrainAcc 0.8970	ValidAcc 0.8894	TestAcc 0.7274
    Epoch 159:	Loss 0.41119	TrainAcc 0.8969	ValidAcc 0.8880	TestAcc 0.7286
    Epoch 169:	Loss 0.40782	TrainAcc 0.8958	ValidAcc 0.8874	TestAcc 0.7230
    Epoch 179:	Loss 0.40460	TrainAcc 0.8998	ValidAcc 0.8916	TestAcc 0.7281
    Epoch 189:	Loss 0.40230	TrainAcc 0.8973	ValidAcc 0.8883	TestAcc 0.7324
    Epoch 199:	Loss 0.40473	TrainAcc 0.9001	ValidAcc 0.8900	TestAcc 0.7336
    Epoch 209:	Loss 0.40036	TrainAcc 0.8998	ValidAcc 0.8902	TestAcc 0.7230
    Epoch 219:	Loss 0.39986	TrainAcc 0.8987	ValidAcc 0.8913	TestAcc 0.7328
    Epoch 229:	Loss 0.39616	TrainAcc 0.8989	ValidAcc 0.8899	TestAcc 0.7376
    Epoch 239:	Loss 0.38994	TrainAcc 0.9006	ValidAcc 0.8925	TestAcc 0.7282
    Epoch 249:	Loss 0.38082	TrainAcc 0.9047	ValidAcc 0.8957	TestAcc 0.7395
    Epoch 259:	Loss 0.37567	TrainAcc 0.9059	ValidAcc 0.8957	TestAcc 0.7376
    Epoch 269:	Loss 0.37233	TrainAcc 0.9062	ValidAcc 0.8966	TestAcc 0.7410
    Epoch 279:	Loss 0.36885	TrainAcc 0.9063	ValidAcc 0.8969	TestAcc 0.7366
    Epoch 289:	Loss 0.36737	TrainAcc 0.9066	ValidAcc 0.8975	TestAcc 0.7370
    Epoch 299:	Loss 0.36603	TrainAcc 0.9055	ValidAcc 0.8946	TestAcc 0.7396
    Epoch 309:	Loss 0.36559	TrainAcc 0.9092	ValidAcc 0.8993	TestAcc 0.7372
    Epoch 319:	Loss 0.36542	TrainAcc 0.9051	ValidAcc 0.8962	TestAcc 0.7407
    Epoch 329:	Loss 0.36834	TrainAcc 0.9054	ValidAcc 0.8958	TestAcc 0.7451
    Epoch 339:	Loss 0.36610	TrainAcc 0.9086	ValidAcc 0.8973	TestAcc 0.7407
    Epoch 349:	Loss 0.36686	TrainAcc 0.9073	ValidAcc 0.8988	TestAcc 0.7411
    Epoch 359:	Loss 0.36652	TrainAcc 0.9066	ValidAcc 0.8954	TestAcc 0.7378
    Epoch 369:	Loss 0.36576	TrainAcc 0.9045	ValidAcc 0.8956	TestAcc 0.7409
    Epoch 379:	Loss 0.36162	TrainAcc 0.9067	ValidAcc 0.8974	TestAcc 0.7369
    Epoch 389:	Loss 0.35623	TrainAcc 0.9112	ValidAcc 0.8993	TestAcc 0.7486
    Epoch 399:	Loss 0.34721	TrainAcc 0.9121	ValidAcc 0.9009	TestAcc 0.7448
    Epoch 409:	Loss 0.34407	TrainAcc 0.9126	ValidAcc 0.9017	TestAcc 0.7478
    Epoch 419:	Loss 0.34224	TrainAcc 0.9115	ValidAcc 0.9006	TestAcc 0.7458
    Epoch 429:	Loss 0.34069	TrainAcc 0.9119	ValidAcc 0.9009	TestAcc 0.7446
    Epoch 439:	Loss 0.33895	TrainAcc 0.9137	ValidAcc 0.9024	TestAcc 0.7474
    Epoch 449:	Loss 0.33916	TrainAcc 0.9123	ValidAcc 0.9027	TestAcc 0.7424
    Epoch 459:	Loss 0.33821	TrainAcc 0.9130	ValidAcc 0.9029	TestAcc 0.7517
    Epoch 469:	Loss 0.33898	TrainAcc 0.9115	ValidAcc 0.9003	TestAcc 0.7403
    Epoch 479:	Loss 0.33792	TrainAcc 0.9139	ValidAcc 0.9020	TestAcc 0.7426
    Epoch 489:	Loss 0.33628	TrainAcc 0.9134	ValidAcc 0.9012	TestAcc 0.7499
    Epoch 499:	Loss 0.33744	TrainAcc 0.9123	ValidAcc 0.9006	TestAcc 0.7413
    Epoch 509:	Loss 0.33726	TrainAcc 0.9144	ValidAcc 0.9022	TestAcc 0.7489
    Epoch 519:	Loss 0.33742	TrainAcc 0.9122	ValidAcc 0.9024	TestAcc 0.7448
    Epoch 529:	Loss 0.33767	TrainAcc 0.9116	ValidAcc 0.9009	TestAcc 0.7389
    Epoch 539:	Loss 0.33586	TrainAcc 0.9140	ValidAcc 0.9014	TestAcc 0.7515
    Epoch 549:	Loss 0.33364	TrainAcc 0.9134	ValidAcc 0.9022	TestAcc 0.7374
    Epoch 559:	Loss 0.33075	TrainAcc 0.9147	ValidAcc 0.9032	TestAcc 0.7510
    Epoch 569:	Loss 0.32755	TrainAcc 0.9164	ValidAcc 0.9035	TestAcc 0.7491
    Epoch 579:	Loss 0.32400	TrainAcc 0.9158	ValidAcc 0.9042	TestAcc 0.7451
    Epoch 589:	Loss 0.32226	TrainAcc 0.9167	ValidAcc 0.9046	TestAcc 0.7486
    Epoch 599:	Loss 0.32017	TrainAcc 0.9165	ValidAcc 0.9046	TestAcc 0.7443
    Epoch 609:	Loss 0.31930	TrainAcc 0.9171	ValidAcc 0.9056	TestAcc 0.7490
    Epoch 619:	Loss 0.32138	TrainAcc 0.9156	ValidAcc 0.9035	TestAcc 0.7413
    Epoch 629:	Loss 0.32100	TrainAcc 0.9166	ValidAcc 0.9030	TestAcc 0.7470
    Epoch 639:	Loss 0.32411	TrainAcc 0.9139	ValidAcc 0.9026	TestAcc 0.7467
    Epoch 649:	Loss 0.32687	TrainAcc 0.9144	ValidAcc 0.9048	TestAcc 0.7374
    Epoch 659:	Loss 0.32939	TrainAcc 0.9146	ValidAcc 0.9025	TestAcc 0.7447
    Epoch 669:	Loss 0.33005	TrainAcc 0.9138	ValidAcc 0.9005	TestAcc 0.7462
    Epoch 679:	Loss 0.33267	TrainAcc 0.9124	ValidAcc 0.9004	TestAcc 0.7426
    Epoch 689:	Loss 0.32902	TrainAcc 0.9150	ValidAcc 0.9023	TestAcc 0.7469
    Epoch 699:	Loss 0.32645	TrainAcc 0.9166	ValidAcc 0.9052	TestAcc 0.7456
    Epoch 709:	Loss 0.32505	TrainAcc 0.9154	ValidAcc 0.9022	TestAcc 0.7416
    Epoch 719:	Loss 0.32329	TrainAcc 0.9164	ValidAcc 0.9016	TestAcc 0.7538
    Epoch 729:	Loss 0.32051	TrainAcc 0.9166	ValidAcc 0.9054	TestAcc 0.7376
    Epoch 739:	Loss 0.31826	TrainAcc 0.9175	ValidAcc 0.9022	TestAcc 0.7493
    Epoch 749:	Loss 0.31546	TrainAcc 0.9185	ValidAcc 0.9040	TestAcc 0.7464
    Epoch 759:	Loss 0.31382	TrainAcc 0.9169	ValidAcc 0.9055	TestAcc 0.7453
    Epoch 769:	Loss 0.31165	TrainAcc 0.9186	ValidAcc 0.9053	TestAcc 0.7467
    Epoch 779:	Loss 0.31085	TrainAcc 0.9173	ValidAcc 0.9028	TestAcc 0.7443
    Epoch 789:	Loss 0.30965	TrainAcc 0.9185	ValidAcc 0.9052	TestAcc 0.7469
    Epoch 799:	Loss 0.31142	TrainAcc 0.9171	ValidAcc 0.9037	TestAcc 0.7382
    Epoch 809:	Loss 0.31263	TrainAcc 0.9179	ValidAcc 0.9050	TestAcc 0.7489
    Epoch 819:	Loss 0.31328	TrainAcc 0.9191	ValidAcc 0.9030	TestAcc 0.7458
    Epoch 829:	Loss 0.31828	TrainAcc 0.9136	ValidAcc 0.9021	TestAcc 0.7389
    Epoch 839:	Loss 0.31722	TrainAcc 0.9172	ValidAcc 0.9048	TestAcc 0.7462
    Epoch 849:	Loss 0.31528	TrainAcc 0.9192	ValidAcc 0.9054	TestAcc 0.7421
    Epoch 859:	Loss 0.31605	TrainAcc 0.9168	ValidAcc 0.9054	TestAcc 0.7519
    Epoch 869:	Loss 0.31569	TrainAcc 0.9180	ValidAcc 0.9041	TestAcc 0.7438
    Epoch 879:	Loss 0.31523	TrainAcc 0.9173	ValidAcc 0.9044	TestAcc 0.7381
    Epoch 889:	Loss 0.31304	TrainAcc 0.9175	ValidAcc 0.9054	TestAcc 0.7517
    Epoch 899:	Loss 0.31171	TrainAcc 0.9161	ValidAcc 0.9046	TestAcc 0.7390
    Epoch 909:	Loss 0.30879	TrainAcc 0.9183	ValidAcc 0.9064	TestAcc 0.7464
    Epoch 919:	Loss 0.30769	TrainAcc 0.9183	ValidAcc 0.9051	TestAcc 0.7449
    Epoch 929:	Loss 0.30557	TrainAcc 0.9199	ValidAcc 0.9066	TestAcc 0.7518
    Epoch 939:	Loss 0.30530	TrainAcc 0.9197	ValidAcc 0.9061	TestAcc 0.7380
    Epoch 949:	Loss 0.30393	TrainAcc 0.9205	ValidAcc 0.9076	TestAcc 0.7465
    Epoch 959:	Loss 0.30290	TrainAcc 0.9204	ValidAcc 0.9060	TestAcc 0.7484
    Epoch 969:	Loss 0.30249	TrainAcc 0.9191	ValidAcc 0.9065	TestAcc 0.7393
    Epoch 979:	Loss 0.30028	TrainAcc 0.9211	ValidAcc 0.9076	TestAcc 0.7495
    Epoch 989:	Loss 0.30062	TrainAcc 0.9183	ValidAcc 0.9063	TestAcc 0.7436
Node 0, Layer-level comm throughput (act): -nan GBps
Node 1, Layer-level comm throughput (act): 10.626 GBps
Node 2, Layer-level comm throughput (act): 9.572 GBps
Node 3, Layer-level comm throughput (act): 12.030 GBps
Node 3, Layer-level comm throughput (grad): -nan GBps
Node 2, Layer-level comm throughput (grad): 13.280 GBps
Node 1, Layer-level comm throughput (grad): 10.563 GBps
Node 0, Layer-level comm throughput (grad): 11.411 GBps
Node 3, compression time: 7.510s, compression size: 1167.788GB, throughput: 155.488GBps
Node 3, decompression time: 9.895s, compression size: 1167.788GB, throughput: 118.022GBps
Node 3, pure compute time: 68.099 s, total compute time: 85.504 s
Node 3, wait_for_task_time: 8.424 s, wait_for_other_gpus_time: 0.005 s
------------------------node id 3,  per-epoch time: 0.129938 s---------------
Node 2, compression time: 12.086s, compression size: 2335.576GB, throughput: 193.251GBps
Node 2, decompression time: 16.410s, compression size: 2335.576GB, throughput: 142.328GBps
Node 2, pure compute time: 66.199 s, total compute time: 94.695 s
Node 2, wait_for_task_time: 17.685 s, wait_for_other_gpus_time: 0.004 s
------------------------node id 2,  per-epoch time: 0.129938 s---------------
Node 1, compression time: 12.738s, compression size: 2335.576GB, throughput: 183.358GBps
Node 1, decompression time: 28.223s, compression size: 2335.576GB, throughput: 82.754GBps
Node 1, pure compute time: 66.367 s, total compute time: 107.328 s
Node 1, wait_for_task_time: 11.738 s, wait_for_other_gpus_time: 0.006 s
------------------------node id 1,  per-epoch time: 0.129938 s---------------
    Epoch 999:	Loss 0.30117	TrainAcc 0.9207	ValidAcc 0.9077	TestAcc 0.7425
Node 0, compression time: 4.940s, compression size: 1167.788GB, throughput: 236.414GBps
Node 0, decompression time: 12.307s, compression size: 1167.788GB, throughput: 94.886GBps
Node 0, pure compute time: 73.536 s, total compute time: 90.783 s
Node 0, wait_for_task_time: 31.385 s, wait_for_other_gpus_time: 0.004 s
------------------------node id 0,  per-epoch time: 0.129938 s---------------
ERROR: undercount the overhead: breakdown sum / all time: 0.722
ERROR: undercount the overhead: breakdown sum / all time: 0.722
ERROR: undercount the overhead: breakdown sum / all time: 0.722
ERROR: undercount the overhead: breakdown sum / all time: 0.722
************ Profiling Results ************
	Bubble: 10.260490 (s) (10.82 percentage)
	Compute: 68.694475 (s) (72.46 percentage)
	GradSync: 0.329710 (s) (0.35 percentage)
	GraphComm: 0.027836 (s) (0.03 percentage)
	Imbalance: 10.374206 (s) (10.94 percentage)
	LayerComm: 5.120616 (s) (5.40 percentage)
	Layer-level communication (cluster-wide, per epoch): 1.151 GB
Highest valid_acc: 0.9077
Target test_acc: 0.7425
Epoch to reach the target acc: 1000
[MPI Rank 0] Success 
[MPI Rank 3] Success 
[MPI Rank 2] Success 
[MPI Rank 1] Success 
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 0
Learning rate: 0.000000
Initialized node g002.anvil.rcac.purdue.edu
Building the CSR structure...
        It takes 1.934 seconds.
Building the CSC structure...
        It takes 1.899 seconds.
Building the Feature Vector...
        It takes 0.576 seconds.
Building the Label Vector...
        It takes 0.311 seconds.
Number of classes: 47
Number of feature dimensions: 100
Dropout: 0.000 
train nodes 196615, valid nodes 39323, test nodes 2213091
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 47
    Number of vertices: 2449029
*** Done preparing the STD tensor.
Version 0	TrainAcc 0.5169	ValidAcc 0.5161	TestAcc 0.4148
Version 1	TrainAcc 0.6195	ValidAcc 0.6195	TestAcc 0.4954
Version 2	TrainAcc 0.7921	ValidAcc 0.7904	TestAcc 0.6233
Version 3	TrainAcc 0.8359	ValidAcc 0.8274	TestAcc 0.6604
Version 4	TrainAcc 0.8525	ValidAcc 0.8436	TestAcc 0.6779
Version 5	TrainAcc 0.8695	ValidAcc 0.8639	TestAcc 0.6939
Version 6	TrainAcc 0.8755	ValidAcc 0.8696	TestAcc 0.7015
Version 7	TrainAcc 0.8821	ValidAcc 0.8743	TestAcc 0.7108
Version 8	TrainAcc 0.8855	ValidAcc 0.8778	TestAcc 0.7142
Version 9	TrainAcc 0.8886	ValidAcc 0.8806	TestAcc 0.7243
Version 10	TrainAcc 0.8916	ValidAcc 0.8847	TestAcc 0.7285
Version 11	TrainAcc 0.8945	ValidAcc 0.8872	TestAcc 0.7370
Version 12	TrainAcc 0.8967	ValidAcc 0.8886	TestAcc 0.7349
Version 13	TrainAcc 0.8972	ValidAcc 0.8891	TestAcc 0.7426
Version 14	TrainAcc 0.8969	ValidAcc 0.8898	TestAcc 0.7436
Version 15	TrainAcc 0.8988	ValidAcc 0.8905	TestAcc 0.7451
Version 16	TrainAcc 0.8990	ValidAcc 0.8916	TestAcc 0.7427
Version 17	TrainAcc 0.9010	ValidAcc 0.8943	TestAcc 0.7424
Version 18	TrainAcc 0.8963	ValidAcc 0.8907	TestAcc 0.7489
Version 19	TrainAcc 0.9022	ValidAcc 0.8948	TestAcc 0.7556
Version 20	TrainAcc 0.8990	ValidAcc 0.8912	TestAcc 0.7365
Version 21	TrainAcc 0.8976	ValidAcc 0.8912	TestAcc 0.7426
Version 22	TrainAcc 0.9001	ValidAcc 0.8936	TestAcc 0.7589
Version 23	TrainAcc 0.9047	ValidAcc 0.8960	TestAcc 0.7485
Version 24	TrainAcc 0.9074	ValidAcc 0.8996	TestAcc 0.7585
Version 25	TrainAcc 0.9078	ValidAcc 0.8986	TestAcc 0.7564
Version 26	TrainAcc 0.9085	ValidAcc 0.9000	TestAcc 0.7583
Version 27	TrainAcc 0.9080	ValidAcc 0.9008	TestAcc 0.7579
Version 28	TrainAcc 0.9084	ValidAcc 0.9002	TestAcc 0.7539
Version 29	TrainAcc 0.9086	ValidAcc 0.8971	TestAcc 0.7624
Version 30	TrainAcc 0.9099	ValidAcc 0.9013	TestAcc 0.7575
Version 31	TrainAcc 0.9061	ValidAcc 0.8985	TestAcc 0.7561
Version 32	TrainAcc 0.9105	ValidAcc 0.9015	TestAcc 0.7693
Version 33	TrainAcc 0.9092	ValidAcc 0.8994	TestAcc 0.7568
Version 34	TrainAcc 0.9070	ValidAcc 0.9003	TestAcc 0.7591
Version 35	TrainAcc 0.9063	ValidAcc 0.8984	TestAcc 0.7574
Version 36	TrainAcc 0.9073	ValidAcc 0.8977	TestAcc 0.7628
Version 37	TrainAcc 0.9106	ValidAcc 0.9019	TestAcc 0.7598
Version 38	TrainAcc 0.9128	ValidAcc 0.9042	TestAcc 0.7672
Version 39	TrainAcc 0.9134	ValidAcc 0.9039	TestAcc 0.7663
Version 40	TrainAcc 0.9139	ValidAcc 0.9045	TestAcc 0.7682
Version 41	TrainAcc 0.9134	ValidAcc 0.9041	TestAcc 0.7685
Version 42	TrainAcc 0.9147	ValidAcc 0.9059	TestAcc 0.7682
Version 43	TrainAcc 0.9153	ValidAcc 0.9055	TestAcc 0.7683
Version 44	TrainAcc 0.9152	ValidAcc 0.9050	TestAcc 0.7644
Version 45	TrainAcc 0.9143	ValidAcc 0.9056	TestAcc 0.7722
Version 46	TrainAcc 0.9147	ValidAcc 0.9035	TestAcc 0.7658
Version 47	TrainAcc 0.9165	ValidAcc 0.9057	TestAcc 0.7637
Version 48	TrainAcc 0.9144	ValidAcc 0.9050	TestAcc 0.7717
Version 49	TrainAcc 0.9156	ValidAcc 0.9053	TestAcc 0.7654
Version 50	TrainAcc 0.9149	ValidAcc 0.9042	TestAcc 0.7684
Version 51	TrainAcc 0.9141	ValidAcc 0.9044	TestAcc 0.7687
Version 52	TrainAcc 0.9146	ValidAcc 0.9050	TestAcc 0.7623
Version 53	TrainAcc 0.9178	ValidAcc 0.9060	TestAcc 0.7753
Version 54	TrainAcc 0.9169	ValidAcc 0.9070	TestAcc 0.7636
Version 55	TrainAcc 0.9169	ValidAcc 0.9069	TestAcc 0.7717
Version 56	TrainAcc 0.9183	ValidAcc 0.9065	TestAcc 0.7740
Version 57	TrainAcc 0.9167	ValidAcc 0.9065	TestAcc 0.7655
Version 58	TrainAcc 0.9189	ValidAcc 0.9079	TestAcc 0.7693
Version 59	TrainAcc 0.9183	ValidAcc 0.9071	TestAcc 0.7681
Version 60	TrainAcc 0.9175	ValidAcc 0.9070	TestAcc 0.7710
Version 61	TrainAcc 0.9189	ValidAcc 0.9082	TestAcc 0.7673
Version 62	TrainAcc 0.9179	ValidAcc 0.9068	TestAcc 0.7672
Version 63	TrainAcc 0.9179	ValidAcc 0.9070	TestAcc 0.7727
Version 64	TrainAcc 0.9156	ValidAcc 0.9067	TestAcc 0.7641
Version 65	TrainAcc 0.9155	ValidAcc 0.9077	TestAcc 0.7654
Version 66	TrainAcc 0.9142	ValidAcc 0.9029	TestAcc 0.7660
Version 67	TrainAcc 0.9153	ValidAcc 0.9052	TestAcc 0.7661
Version 68	TrainAcc 0.9183	ValidAcc 0.9080	TestAcc 0.7705
Version 69	TrainAcc 0.9179	ValidAcc 0.9067	TestAcc 0.7692
Version 70	TrainAcc 0.9169	ValidAcc 0.9047	TestAcc 0.7605
Version 71	TrainAcc 0.9174	ValidAcc 0.9069	TestAcc 0.7776
Version 72	TrainAcc 0.9183	ValidAcc 0.9093	TestAcc 0.7631
Version 73	TrainAcc 0.9193	ValidAcc 0.9083	TestAcc 0.7684
Version 74	TrainAcc 0.9201	ValidAcc 0.9070	TestAcc 0.7710
Version 75	TrainAcc 0.9192	ValidAcc 0.9091	TestAcc 0.7674
Version 76	TrainAcc 0.9200	ValidAcc 0.9085	TestAcc 0.7711
Version 77	TrainAcc 0.9205	ValidAcc 0.9083	TestAcc 0.7684
Version 78	TrainAcc 0.9203	ValidAcc 0.9072	TestAcc 0.7719
Version 79	TrainAcc 0.9197	ValidAcc 0.9096	TestAcc 0.7638
Version 80	TrainAcc 0.9205	ValidAcc 0.9100	TestAcc 0.7714
Version 81	TrainAcc 0.9184	ValidAcc 0.9054	TestAcc 0.7679
Version 82	TrainAcc 0.9180	ValidAcc 0.9071	TestAcc 0.7649
Version 83	TrainAcc 0.9215	ValidAcc 0.9118	TestAcc 0.7712
Version 84	TrainAcc 0.9205	ValidAcc 0.9080	TestAcc 0.7647
Version 85	TrainAcc 0.9185	ValidAcc 0.9070	TestAcc 0.7719
Version 86	TrainAcc 0.9183	ValidAcc 0.9089	TestAcc 0.7729
Version 87	TrainAcc 0.9187	ValidAcc 0.9085	TestAcc 0.7584
Version 88	TrainAcc 0.9192	ValidAcc 0.9064	TestAcc 0.7729
Version 89	TrainAcc 0.9194	ValidAcc 0.9081	TestAcc 0.7653
Version 90	TrainAcc 0.9202	ValidAcc 0.9101	TestAcc 0.7701
Version 91	TrainAcc 0.9227	ValidAcc 0.9112	TestAcc 0.7673
Version 92	TrainAcc 0.9221	ValidAcc 0.9106	TestAcc 0.7748
Version 93	TrainAcc 0.9222	ValidAcc 0.9101	TestAcc 0.7655
Version 94	TrainAcc 0.9226	ValidAcc 0.9114	TestAcc 0.7665
Version 95	TrainAcc 0.9211	ValidAcc 0.9078	TestAcc 0.7739
Version 96	TrainAcc 0.9226	ValidAcc 0.9108	TestAcc 0.7625
Version 97	TrainAcc 0.9220	ValidAcc 0.9100	TestAcc 0.7710
Version 98	TrainAcc 0.9214	ValidAcc 0.9089	TestAcc 0.7691
Version 99	TrainAcc 0.9236	ValidAcc 0.9109	TestAcc 0.7676
Version 83 achieved the highest validation accuracy 0.9118 (test accuracy: 0.7712)
