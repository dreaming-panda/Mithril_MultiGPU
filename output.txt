g003.anvil.rcac.purdue.edu
Sun Jan 22 20:53:01 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 470.57.02    Driver Version: 470.57.02    CUDA Version: 11.4     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA A100-SXM...  On   | 00000000:C1:00.0 Off |                    0 |
| N/A   36C    P0    53W / 400W |      0MiB / 40536MiB |      0%      Default |
|                               |                      |             Disabled |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|  No running processes found                                                 |
+-----------------------------------------------------------------------------+

Currently Loaded Modules:
  1) modtree/gpu            5) mpfr/4.0.2    9) numactl/2.0.14
  2) nccl/cuda-11.2_2.8.4   6) mpc/1.1.0    10) cuda/11.4.2
  3) cudnn/cuda-11.2_8.1    7) gcc/11.2.0   11) openmpi/4.0.6
  4) gmp/6.2.1              8) zlib/1.2.11  12) boost/1.74.0

 

[  4%] Built target context
[ 17%] Built target parallel
[ 19%] Built target core
[ 40%] Built target cudahelp
[ 57%] Built target test_mpi_gpu_model_parallel
[ 57%] Built target test_cuda_model_parallel
[ 57%] Built target test_mpi_gpu_hybrid
[ 73%] Built target test_mpi_model_parallel
[ 57%] Built target test_mpi_gpu_pipelined_model_parallel
[ 73%] Built target test_cuda
[ 73%] Built target test_cuda_pipeline_parallel
[ 73%] Built target test_cuda_graph
[ 73%] Built target test_full_structual_graph
[ 73%] Built target test_mpi_pipelined_model_parallel
[ 73%] Built target test_nccl_thread
[ 73%] Built target test_single_node_training
[ 73%] Built target test_full_non_structual_graph
[ 78%] Built target test_mpi_structual_graph
[ 78%] Built target test_graph
[ 78%] Built target test_mpi_loader
[ 78%] Built target test_hello_world
[ 83%] Built target test_single_node_gpu_training
[ 87%] Built target test_mpi_non_structual_graph
[ 89%] Built target test_mpi_combined
[ 89%] Built target test_single_node_fullgpu_training
[ 87%] Built target estimate_comm_volume
[ 89%] Built target test_nccl_mpi
[ 89%] Built target test_trivial
[ 93%] Built target OSDI2023_SINGLE_NODE_gcn_inference
[ 95%] Built target test_two_layer_hybrid_parallelism_designer
[ 98%] Built target OSDI2023_MULTI_NODES_gcn
[100%] Built target OSDI2023_SINGLE_NODE_gcn
[100%] Built target OSDI2023_MULTI_NODES_gcn_graph_parallel
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 100
Learning rate: 0.003000
Initialized node g003.anvil.rcac.purdue.edu
Building the CSR structure...
        It takes 1.965 seconds.
Building the CSC structure...
        It takes 1.933 seconds.
Building the Feature Vector...
        It takes 0.566 seconds.
Building the Label Vector...
        It takes 0.309 seconds.
Number of classes: 47
Number of feature dimensions: 100
Dropout: 0.300 
train nodes 196615, valid nodes 39323, test nodes 2213091
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 47
    Number of vertices: 2449029
*** Done preparing the STD tensor.
*** Done preparing the weight tensor.

****** Start model training... ******
    Epoch 9:	Loss 1.52178	TrainAcc 0.6187	ValidAcc 0.6136	TestAcc 0.4886
    Epoch 19:	Loss 0.81432	TrainAcc 0.8296	ValidAcc 0.8240	TestAcc 0.6555
    Epoch 29:	Loss 0.62348	TrainAcc 0.8607	ValidAcc 0.8557	TestAcc 0.6886
    Epoch 39:	Loss 0.53741	TrainAcc 0.8753	ValidAcc 0.8700	TestAcc 0.7035
    Epoch 49:	Loss 0.48703	TrainAcc 0.8843	ValidAcc 0.8780	TestAcc 0.7150
    Epoch 59:	Loss 0.45632	TrainAcc 0.8894	ValidAcc 0.8824	TestAcc 0.7218
    Epoch 69:	Loss 0.43397	TrainAcc 0.8932	ValidAcc 0.8863	TestAcc 0.7282
    Epoch 79:	Loss 0.41762	TrainAcc 0.8958	ValidAcc 0.8891	TestAcc 0.7345
    Epoch 89:	Loss 0.40571	TrainAcc 0.8988	ValidAcc 0.8914	TestAcc 0.7389
    Epoch 99:	Loss 0.39548	TrainAcc 0.9005	ValidAcc 0.8939	TestAcc 0.7426

Average per-epoch runtime: 0.236 (s)
Total Time: 22.622(s)
loss Time: 0.065(s)
calacc Time: 0.586(s)
calgra Time: 0.471(s)
cf Time: 10.013(s)
cb Time: 12.750(s)
Highest validation acc: 0.8939
Target test acc: 0.7426
Epochs to reach the target acc: 100
The runtime of each operator:
	Op 0 (OPERATOR_INPUT),	Rumtime: 0.000000 s
	Op 1 (OPERATOR_WEIGHT),	Rumtime: 0.000000 s
	Op 2 (OPERATOR_MATMUL),	Rumtime: 1.224066 s
	Op 3 (OPERATOR_AGGREGATION),	Rumtime: 3.360200 s
	Op 4 (OPERATOR_RELU),	Rumtime: 0.553570 s
	Op 5 (OPERATOR_DROPOUT),	Rumtime: 0.410386 s
	Op 6 (OPERATOR_WEIGHT),	Rumtime: 0.000014 s
	Op 7 (OPERATOR_MATMUL),	Rumtime: 1.301857 s
	Op 8 (OPERATOR_AGGREGATION),	Rumtime: 3.356832 s
	Op 9 (OPERATOR_RELU),	Rumtime: 0.552903 s
	Op 10 (OPERATOR_DROPOUT),	Rumtime: 0.409500 s
	Op 11 (OPERATOR_WEIGHT),	Rumtime: 0.000008 s
	Op 12 (OPERATOR_MATMUL),	Rumtime: 1.300647 s
	Op 13 (OPERATOR_AGGREGATION),	Rumtime: 3.355983 s
	Op 14 (OPERATOR_RELU),	Rumtime: 0.552572 s
	Op 15 (OPERATOR_DROPOUT),	Rumtime: 0.409281 s
	Op 16 (OPERATOR_WEIGHT),	Rumtime: 0.000006 s
	Op 17 (OPERATOR_MATMUL),	Rumtime: 0.634820 s
	Op 18 (OPERATOR_AGGREGATION),	Rumtime: 2.751108 s
	Op 19 (OPERATOR_SOFTMAX),	Rumtime: 1.478213 s
The graph dataset locates at /anvil/projects/x-cis220117/gnn_datasets/reordered/ogbn_products
The number of GCN layers: 4
The number of hidden units: 128
The number of training epoches: 0
Learning rate: 0.000000
Initialized node g003.anvil.rcac.purdue.edu
Building the CSR structure...
        It takes 1.951 seconds.
Building the CSC structure...
        It takes 1.901 seconds.
Building the Feature Vector...
        It takes 0.574 seconds.
Building the Label Vector...
        It takes 0.315 seconds.
Number of classes: 47
Number of feature dimensions: 100
Dropout: 0.000 
train nodes 196615, valid nodes 39323, test nodes 2213091
*** Allocating resources for all tensors...
    OP_TYPE: OPERATOR_INPUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_RELU
    OP_TYPE: OPERATOR_DROPOUT
    OP_TYPE: OPERATOR_WEIGHT
    OP_TYPE: OPERATOR_MATMUL
    OP_TYPE: OPERATOR_AGGREGATION
    OP_TYPE: OPERATOR_SOFTMAX
*** Done allocating resource.
*** Preparing the input tensor...
*** Done preparing the input tensor.
*** Preparing the STD tensor...
    Number of labels: 47
    Number of vertices: 2449029
*** Done preparing the STD tensor.
Version 0	TrainAcc 0.6604	ValidAcc 0.6548	TestAcc 0.5260
Version 1	TrainAcc 0.8312	ValidAcc 0.8288	TestAcc 0.6686
Version 2	TrainAcc 0.8625	ValidAcc 0.8571	TestAcc 0.6977
Version 3	TrainAcc 0.8780	ValidAcc 0.8723	TestAcc 0.7110
Version 4	TrainAcc 0.8856	ValidAcc 0.8795	TestAcc 0.7218
Version 5	TrainAcc 0.8903	ValidAcc 0.8839	TestAcc 0.7301
Version 6	TrainAcc 0.8937	ValidAcc 0.8877	TestAcc 0.7369
Version 7	TrainAcc 0.8970	ValidAcc 0.8912	TestAcc 0.7440
Version 8	TrainAcc 0.8992	ValidAcc 0.8935	TestAcc 0.7484
Version 9	TrainAcc 0.9015	ValidAcc 0.8951	TestAcc 0.7532
Version 9 achieved the highest validation accuracy 0.8951 (test accuracy: 0.7532)
